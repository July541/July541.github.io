---
title: 'ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ï¼ˆäº”ï¼‰ï¼šé€»è¾‘æ–¯è°›å›å½’ä¸æœ€å¤§ç†µæ¨¡å‹'
tags:
  - machine learning
  - logistic regression
  - maximum entropy model
  - entropy
categories:
  - ç»Ÿè®¡å­¦ä¹ æ–¹æ³•
date: 2020-07-15 22:03:39
mathjax: true
---

# é€»è¾‘æ–¯è°›å›å½’ä¸æœ€å¤§ç†µæ¨¡å‹

logistic regression æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­çš„ç»å…¸åˆ†ç±»æ–¹æ³•ï¼Œå…¶æ–¹æ³•å¯ç®€å•ç†è§£ä¸ºåœ¨ linear regression ä¸Šåº”ç”¨ sigmoid è¿›è¡Œæ˜ å°„, å°†å…¶è½¬æ¢ä¸ºäºŒåˆ†ç±»é—®é¢˜ã€‚ã€Šç»Ÿè®¡å­¦æ ¡æ–¹æ³•ã€‹ ä¸€ä¹¦é€šè¿‡ logistic distribution è¿›è¡Œæ¨å¯¼ã€‚å°† logistic ç¿»è¯‘æˆé€»è¾‘æ–¯è°›è¿™ç§æ— æ„ä¹‰çš„å•è¯ä¹Ÿå¤ªæ— èŠäº†ï¼Œåæ–‡å°†å…¨éƒ¨ä½¿ç”¨è‹±æ–‡è¡¨è¿°ã€‚

<!--more-->

## logistic regression model

é¦–å…ˆä»‹ç» logistic distribution çš„å®šä¹‰ã€‚

è®¾ $X$ æ˜¯è¿ç»­éšæœºå˜é‡ï¼Œ$X$ æœä» logistic distribution æ˜¯æŒ‡ $X$ å…·æœ‰ä¸‹åˆ—åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°
$$
F(x) = P(X \leqslant x) = \frac{1}{1+e^{-(x-\mu)/\gamma}} \\
f(x) = F'(x) = \frac{e^{-(x-\mu)/\gamma}}{\gamma (1 + e^{-(x-\mu)/\gamma})^2}
$$

åˆ©ç”¨å‚æ•°åŒ–çš„ logistic distribution å¯ä»¥å¾—åˆ° logistic modelã€‚é€šå¸¸æƒ…å†µ logistic model ç”¨äºè¿›è¡ŒäºŒå€¼åˆ†ç±»ï¼Œä¹Ÿå¯ä»¥æ‰©å±•åˆ°å¤šå€¼åˆ†ç±»ã€‚å¯¹äºäºŒå€¼åˆ†ç±»ï¼Œæœ‰å¦‚ä¸‹æ¦‚ç‡åˆ†å¸ƒ
$$
P(Y = 1 | X) = \frac{e^{(w\cdot x+b)}}{1 + e^{(w \cdot x + b)}} = \frac{1}{1 + e^{-(w \cdot x + b)}} \\
P(Y = 0 | X) = \frac{1}{1 + e^{(w \cdot x + b)}} = \frac{e^{-(w \cdot x + b)}}{1 + e^{-(w \cdot x + b)}}
$$
ç°è€ƒå¯Ÿ logistic regression model çš„ç‰¹ç‚¹ï¼Œä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„å‡ ç‡ (odds) æ˜¯æŒ‡è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸è¯¥äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚ç‡çš„æ¯”å€¼ã€‚å¦‚æœæ—¶é—´å‘ç”Ÿçš„æ¦‚ç‡æ˜¯ $p$ï¼Œåˆ™è¯¥äº‹ä»¶å‘ç”Ÿçš„å‡ ç‡æ˜¯ $\frac{p}{1-p}$ï¼Œè¯¥äº‹ä»¶çš„å¯¹æ•°å‡ ç‡ (log odds) å³ logit å‡½æ•°ä¸º
$$
logit(p) = log\frac{p}{1-p}
$$
å¯¹ logistic regressionï¼Œæœ‰
$$
log \frac{P(Y=1|X)}{1-P(Y=0|X)}=w \cdot x + b
$$
ä¹Ÿå°±æ˜¯åœ¨ logistic regression model ä¸­ï¼Œè¾“å‡º $Y=1$ çš„å¯¹æ•°å‡ ç‡æ˜¯è¾“å…¥ $x$ çš„çº¿æ€§å‡½æ•°ï¼Œå³è¯æ˜äº† linear regression ä¸Šåº”ç”¨ sigmoid çš„å¯è¡Œæ€§ã€‚

### æ¨¡å‹å‚æ•°ä¼°è®¡

æ¨¡å‹çš„å‚æ•°ä¼°è®¡å¯ä»¥ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡æ¨¡å‹å‚æ•°ã€‚ä»¤ $h(x) = P(Y=1|X)$, $P(Y=0|X) = 1 - h(x)$ï¼Œæœ‰ä¼¼ç„¶å‡½æ•°
$$
\prod_{i=1}^N{[h(x)]^{y_i} [1-h(x)]^{1-y_i}}
$$
ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œä¸¤è¾¹å–å¯¹æ•°å¾—åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°
$$
L(w) = \sum_{i=1}^N{[y_i\space log\space h(x_i) + (1-y_i) log(1-h(x_i))]}
$$
ä¸ºäº†å¾—åˆ°ä¸Šè¿°å‡½æ•°çš„æå¤§å€¼ï¼Œå¯ä½¿ç”¨æ¢¯åº¦ä¸Šå‡æ±‚å¾— $w$ã€‚

## æœ€å¤§ç†µæ¨¡å‹

### æœ€å¤§ç†µåŸç†

è®¾ç¦»æ•£éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒæ—¶ $P(X)$ï¼Œåˆ™å…¶ç†µä¸º
$$
H(P) = -\sum_{x}P(x) \space log \space P(x)
$$
ç†µçš„å–å€¼æ»¡è¶³å¦‚ä¸‹ä¸ç­‰å¼
$$
0 \leqslant H(P) \leqslant log \space |X|
$$
å…¶ä¸­ï¼Œ$|X|$ æ˜¯ $X$ çš„å–å€¼ä¸ªæ•°ï¼Œå½“ä¸”ä»…å½“ $X$ çš„åˆ†å¸ƒæ˜¯å‡åŒ€åˆ†å¸ƒæ—¶å³è¾¹çš„ç­‰å·æˆç«‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ $X$ æœä»å‡åŒ€åˆ†å¸ƒæ—¶ï¼Œç†µæœ€å¤§ã€‚

**ä¸¾ä¸€ä¸ªğŸŒ°**

è®¾éšæœºå˜é‡ $X$ æœ‰äº”ä¸ªå–å€¼ $\{A,B,C,D,E\}$ï¼Œè¦ä¼°è®¡å–å„ä¸ªå€¼å½“æ¦‚ç‡ $P(A)$ï¼Œ$P(B)$ï¼Œ$P(C)$ï¼Œ$P(D)$ï¼Œ$P(E)$ã€‚

é¦–å…ˆæœ‰
$$
P(A) + P(B) + P(C) + P(D) + P(E) = 1
$$
åœ¨æ²¡æœ‰å…¶ä»–ä»»ä½•ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¯¹æ¦‚ç‡åˆ†å¸ƒåˆç†çš„ä¼°è®¡æ–¹æ³•å°±æ˜¯å‡è®¾è¿™ä¸ªåˆ†å¸ƒä¸­å–å„ä¸ªå€¼çš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„ï¼Œå³
$$
P(A) = P(B) = P(C) + P(D) + P(E) = \frac{1}{5}
$$
ç­‰æ¦‚ç‡è¡¨ç¤ºäº†å¯¹äº‹å®çš„æ— çŸ¥ã€‚å› ä¸ºæ²¡æœ‰æ›´å¤šçŸ¥è¯†ï¼Œè¿™ç§åˆ¤æ–­æ˜¯åˆç†çš„ã€‚

è‹¥æ­¤æ—¶çŸ¥é“
$$
P(A) + P(B) = \frac{3}{10}
$$
åˆ™å¯è®¤ä¸º $A$ ä¸ $B$ æ˜¯ç­‰æ¦‚ç‡çš„ï¼Œ$C$ï¼Œ$D$ ä¸ $E$ æ˜¯ç­‰æ¦‚ç‡çš„ï¼Œå³
$$
P(A) = P(B) = \frac{3}{20} \\
P(C) = P(D) = P(E) = \frac{7}{30}
$$
è¿™ç§æ¦‚ç‡çš„ä¼°è®¡æ–¹æ³•æ­£æ˜¯æœ€å¤§ç†µåŸç†çš„åº”ç”¨ã€‚

### æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰

æœ€å¤§ç†µæ¨¡å‹åˆ©ç”¨æœ€å¤§ç†µåŸç†è¿›è¡Œåˆ†ç±»ã€‚é¦–å…ˆè€ƒè™‘æ¨¡å‹åº”è¯¥æ»¡è¶³çš„æ¡ä»¶ã€‚ç»™å®šè®­ç»ƒæ•°æ®é›†ï¼Œè”åˆåˆ†å¸ƒ $P(X,Y)$ çš„ç»éªŒåˆ†å¸ƒ $\tilde{P}(X,Y)$ å’Œè¾¹ç¼˜åˆ†å¸ƒ $P(X)$ çš„ç»éªŒåˆ†å¸ƒ $\tilde{P}(X)$ åˆ†åˆ«ä¸º
$$
\tilde{P}(X=x,Y=y) = \frac{\nu(X=x,Y=y)}{N} \\
\tilde{P}(X=x) = \frac{\nu(X=x)}{N}
$$
å…¶ä¸­ï¼Œ$\nu(X=x,Y=y)$ è¡¨ç¤ºè®­ç»ƒæ•°æ®ä¸­æ ·æœ¬ $(x,y)$ å‡ºç°çš„é¢‘æ•°ï¼Œ$\nu (X=x)$ è¡¨ç¤ºè®­ç»ƒæ•°æ®ä¸­è¾“å…¥ $x$ å‡ºç°çš„é¢‘æ•°ï¼Œ$N$ è¡¨ç¤ºè®­ç»ƒæ ·æœ¬å®¹é‡ã€‚

ç”¨ç‰¹å¾å‡½æ•° (feature function) $f(x,y)$ æè¿°è¾“å…¥ $x$ å’Œè¾“å‡º $y$ ä¹‹é—´çš„æŸä¸€ä¸ªäº‹å® (ä¾‹å¦‚ $P(A) = \frac{3}{10}$)ï¼Œå…¶å®šä¹‰ä¸º
$$
f(x,y) = \left\{\begin{matrix}
\begin{align}
& 1 , \space \text{x and y satisfy a certain fact}\\ 
& 0 , \space otherwise
\end{align}
\end{matrix}\right.
$$
ç‰¹å¾å‡½æ•° $f(x,y)$ å…³äºç»éªŒåˆ†å¸ƒ $\tilde{P}(X,Y)$ çš„æœŸæœ›å€¼ç”¨ $E_{\tilde{P}}(f)$ è¡¨ç¤ºï¼Œæœ‰
$$
E_{\tilde{P}}(f) = \sum_{x,y}\tilde{P}(x,y)f(x,y)
$$
ç‰¹å¾å‡½æ•° $f(x,y)$ å…³äºæ¨¡å‹ $P(Y|X)$ ä¸ç»éªŒåˆ†å¸ƒ $\tilde{P}(X)$ çš„æœŸæœ›å€¼ç”¨ $E_P(f)$ è¡¨ç¤ºï¼Œæœ‰
$$
E_P(f) = \sum_{x,y}\tilde{P}(x)P(y|x)f(x,y)
$$
åœ¨æ¨¡å‹èƒ½ä»è®­ç»ƒæ•°æ®ä¸­è·å¾—è¶³å¤Ÿä¿¡æ¯çš„å‰æä¸‹ï¼Œå¯ä»¥å‡è®¾è¿™ä¸¤ä¸ªæœŸæœ›å€¼ç›¸ç­‰ (ç”±$P(A,B) = P(A|B)P(B)$)ï¼Œå³
$$
E_P(f) = E_{\tilde{P}}(f)
$$
ä»¥ä¸Šå¼ä¸ºçº¦æŸæ¡ä»¶ï¼Œæœ‰æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰ï¼š

å‡è®¾æ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸º
$$
C \equiv \{P \in \wp | E_P(f_i)=E_\tilde{P}(f), i=1,2,\cdots,n\}
$$
å®šä¹‰åœ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y|X)$ ä¸Šçš„æ¡ä»¶ç†µä¸º
$$
H(P)=-\sum_{x,y}{\tilde{P}(x)P(y|x)logP(y|x)}
$$
åˆ™æ¨¡å‹é›†åˆ $C$ ä¸­çš„æ¡ä»¶ç†µ $H(P)$ æœ€å¤§çš„æ¨¡å‹ç§°ä¸ºæœ€å¤§ç†µæ¨¡å‹ã€‚å¼ä¸­çš„å¯¹æ•°ä¸ºè‡ªç„¶å¯¹æ•° $e$ã€‚

### æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ 

æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ å¯ä»¥å½¢å¼åŒ–ä¸ºçº¦æŸæœ€ä¼˜åŒ–é—®é¢˜
$$
\underset{P \in C}{max} H(P) = -\sum_{x,y}{\tilde{P}(x)P(y|x)logP(y|x))} \\
s.t. \quad E_p(f_i) = E_{\tilde{P}}(f_i), \space 1, 2, \cdots, n \\
\sum_{y}{p(y|x)} = 1
$$
æŒ‰ç…§æœ€ä¼˜åŒ–é—®é¢˜çš„ä¹ æƒ¯ï¼Œå°†æœ€å¤§å€¼æ±‚è§£é—®é¢˜æ”¹ä¸ºç­‰ä»·çš„æ±‚æœ€å°å€¼é—®é¢˜
$$
\underset{P \in C}{min} \space-H(P) = \sum_{x,y}{\tilde{P}(x)P(y|x)logP(y|x))} \\
s.t. \quad E_p(f_i) = E_{\tilde{P}}(f_i), \space 1, 2, \cdots, n \\
\sum_{y}{p(y|x)} = 1
$$
æ±‚è§£ä¸Šè¿°é—®é¢˜å¾—å‡ºçš„è§£å°±æ˜¯æœ€å¤§ç†µæ¨¡å‹çš„è§£ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆåˆ©ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•å°†å¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºæ— çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œå¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $w_0,w_1,\cdots,w_n$ï¼Œå®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•° $L(P,w)$
$$
\begin{equation}\nonumber
\begin{aligned}
L(P,w) & \equiv -H(P) + w_0\left (1-\sum_{y}{P(y|x)} \right) + \sum_{i=1}^n{w_i(E_{\tilde{P}}(f_i) - E_P(f_i))} \\
&= \sum_{x,y}{\tilde{P}(x)P(y|x)logP(y|x)} + w_0\left (1 - \sum_{y}{P(y|x)}\right ) + \\
& \quad \sum_{i=1}^n{w_i\left (\sum_{x,y}{\tilde{P}(x,y)f_i(x,y)} - \sum_{x,y}{\tilde{P}(x)P(y|x)(f_i(x,y)}\right)}
\end{aligned}
\end{equation}
$$
æœ‰åŸå§‹ä¼˜åŒ–é—®é¢˜
$$
\underset{P\in C}{min}\space\underset{w}{max} \space L(P,w)
$$
åˆ™å…¶å¯¹å¶é—®é¢˜ä¸º
$$
\underset{w}{max} \space \underset{P\in C}{min} \space L(P,w)
$$
ç”±æˆ‘ç°åœ¨è¿˜æ˜¯ä¸æ‡‚çš„ KKT è§„åˆ™å¯ä»¥çŸ¥é“åŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜æ˜¯ç­‰ä»·çš„ã€‚å…ˆæ±‚è§£ $\underset{P\in C}{min}\space L(P,w)$ï¼Œå¯¹ $P(y|x)$ æ±‚åå¯¼æ•°
$$
\begin{equation}\nonumber
\begin{aligned}
\frac{\partial L(P,w)}{\partial P(y|x)} &= \sum_{x,y}{\tilde{P}(x)(logP(y|x)+1)} - \sum_y{w_0} - \sum_{x,y}{\left( \tilde{P}(x)\sum_{i=1}^n{w_i f_i(x,y)}\right)} \\
&= \sum_{x,y}{\tilde{P}(x)\left( logP(y|x) + 1 - w_0 - \sum_{i=1}^n{w_if_i(x,y)}\right)}
\end{aligned}
\end{equation}
$$
ä»¤åå¯¼æ•°ä¸º $0$ï¼Œç”±äº $\tilde{P}(x) > 0$ï¼Œæœ‰
$$
P(y|x) = exp\left( \sum_{i=1}^n{w_i f_i(x,y) + w_0 - 1}\right)=\frac{exp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)}{exp(1-w_0)}
$$
åˆå› ä¸º $\sum_y{P(y|x) = 1}$ï¼Œåˆ™æœ‰
$$
\sum_y{P(y|x)} = \sum_y{\frac{exp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)}{exp(1-w_0)}} = \frac{\sum_yexp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)}{exp(1-w_0)} = 1
$$
å³
$$
exp(1-w_0) = \sum_yexp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)
$$
å¾—æœ€ä¼˜è§£
$$
arg \space \underset{P\in C}{min} \space L(P,w) = P_w(y|x)= \frac{1}{Z_w(x)}exp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)
$$
å…¶ä¸­
$$
Z_w(x) = \sum_yexp\left( \sum_{i=1}^n{w_i f_i(x,y)}\right)
$$
è¿™é‡Œ $Z_w(x)$ è¢«ç§°ä¸ºè§„èŒƒåŒ–å› å­ã€‚

ç°åœ¨å¯ä»¥å¯¹ä¸Šè¿°æœ€å°å€¼è¿›è¡Œæå¤§åŒ–ï¼Œæ±‚ $\underset{w}{\bf{max}} \space \underset{P\in C}{min} \space L(P,w)$ å¯¹åº”çš„ $w$ï¼Œå¯ç›´æ¥æ±‚è§£ï¼Œä¹Ÿå¯ç”¨æ¢¯åº¦ä¸‹é™æ³•ç­‰è¿­ä»£æ³•æ±‚è§£ã€‚
